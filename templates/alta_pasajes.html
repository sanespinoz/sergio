<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>ABM Pasajes</title>
</head>       
<!-- Page styles -->
<link type='text/css' href='css/demo.css' rel='stylesheet' media='screen' />
<link rel="stylesheet" type="text/css" href="./css/estilos.css" /> <!-- Estilos de la tabla -->
<!-- OSX Style CSS files -->
<link type='text/css' href='css/osx.css' rel='stylesheet' media='screen' />
<script  src="./js/datepicker.js"></script>         
<script type="text/javascript" src="./js/jquery-1.3.2.js" ></script>            
<script type="text/javascript" src="./js/jquery.numeric.js"></script>
<script type="text/javascript" src="./js/propias.js" ></script> 

<!---------------------- Script para los mensajes  ---------------------------->
<script src="sweetalert-master/lib/sweet-alert.min.js"></script> 
<link rel="stylesheet" type="text/css" href="sweetalert-master/lib/sweet-alert.css">
<!----------------------------------------------------------------------------->



<script type="text/javascript">                   

        var carg_cliente = true; // true = remitente; false = destinatario        
        $(document).ready(function(){                             
                //--------------------------------------------------------------
                // Determinamos los tipo de caracteres que se pueden escribir en
                //  un text.  
                //  ---------------------------------------------------------
                // Tipo ENTERO
                $("#e_dni_pasaje").numeric();
                $("#e_dni_coseguro_pasaje").numeric();
                //  ---------------------------------------------------------
                // Tipo REAL                
                $("#e_importe_pasaje").numeric(".");
                $("#e_importe_pago").numeric(".");                
                $("#e_importe_coseguro_pasaje").numeric(".");
                //--------------------------------------------------------------
               
                $("#i_escribir_siguiente_pasaje" ).click( function() {cargar_datos_base_a_otro_pasaje();});
                $("#i_vaciar_pasaje" ).click( function() {vaciar_pasaje();});
                $("#e_tipo_pasaje").change( function()   {seleccionar_tipo_pasaje();});
               // $("#e_tipo_pasaje").change( function() {seleccionar_tipo_pasaje();});
                
                $('#e_coseguro_pasaje > option[value="N"]').attr('selected', 'selected');
                $("#e_coseguro_pasaje").change(function(){cambiar_estado_cooseguro();}); 
                
                
                //--------------------------------------------------------------------------------------------------
                // eventos de la busqueda de clientes
                //--------------------------------------------------------------------------------------------------
                //$("#e_buscar_remitente").     mouseover( function(){carg_cliente = 0;}); // busqueda de remitente
                $("#e_buscar_destinatario").  mouseover( function(){             
                    carg_cliente = 1;
                    //$('#e_buscar').focus();
                }); // busqueda de destinatario
                
                $("#e_buscar_cliente_ctacte").mouseover( function(){
                    carg_cliente = 2;
                    //$('#e_buscar').focus();
                }); // busqueda de cliente de cta. cte.
                
                $("#b_aceptar_clientes"    ).click(function(){seleccionar_cliente_buscado(carg_cliente); });
                $("#b_buscar"              ).click(function(){buscar_clientes();                    });
                $("#e_buscar"              ).keypress(function(e) { 
                        if(e.which == 13) {
                            buscar_clientes(); 
                        }                        
                });

                //--------------------------------------------------------------------------------------------------
                //----------------  eventos de la Alta de clientes -------------------------------------------------
                //--------------------------------------------------------------------------------------------------
                $("#e_alta_destinatario"   ).click(function(){abrir_ventana('Alta de clientes','./abm/abm_clientes.php',400,600); });
                
                
                
                //---------------------------------------------------------------------------------------------------
                //----------------  botones en forma des pagos  -----------------------------------------------------
                //---------------------------------------------------------------------------------------------------
                $("#carga_datos_pagos").css('background-color',"#F5ECCE");
                $("#e_forma_de_pago_contado" ).change( function() { seleccionar_forma_de_pagos(); });
                $("#e_forma_de_pago_ctacte"  ).change( function() { seleccionar_forma_de_pagos(); });
                //$("#e_forma_de_pago_cheque"  ).change( function() { seleccionar_forma_de_pagos(); });
                //$("#e_forma_de_pago_destino" ).change( function() { seleccionar_forma_de_pagos(); });

                $("#b_agregar_pago"  ).click(function(){agregar_pago_al_listado_de_pago();      });
                $("#b_vaciar_la_tabla_pago"     ).click(function(){vaciar_tabla_pago();         });
                $("#b_eliminar_pago" ).click(function(){eliminar_pago_al_listado_pago();        });

                $("#e_buscar_cliente_ctacte").mouseover( function(){carg_cliente = 2;}); // busqueda de cliente de cta. cte.
                $("#e_alta_cliente_ctacte" ).click(function(){abrir_ventana('Alta de clientes','./abm/abm_clientes.php',400,600); });
                $("#e_alta_banco_ctacte"   ).click(function(){abrir_ventana('Alta de bancos'  ,'./abm/abm_bancos.php',  400,600); });
                
                //----------------------------------------------------------------------------------------------------
                //                                   botonera de mando final.
                //----------------------------------------------------------------------------------------------------
                $("#i_aceptar").click(function() {escribir_en_tabla();   });
                $("#i_cancelar").click(function(){cerrar_ventana();      });    
                
                habilitar_seccion_de_pagos();
        });
        //------------------------------------------------------------------------------
        // Realiza la busqueda de clientes de lo escrito en el edit de busqueda por sql
	function buscar_clientes() {                       
                var parametros = {code : $("#e_buscar").val()};
                var tbuscliente = '';
                
                $.ajax({
                           data: parametros,
                           url : 'ajax_buscar_clientes.php',
                           type: 'post',
                           beforeSend: function () {
                               $("#t_buscar").html("Procesando, espere por favor...");
                                                   },
                           success:  function (resultado) {
                                    tbuscliente = resultado.split('@|@')
                                    $("#t_buscar").html(tbuscliente[0]);
                                                          }
                            });                   
        };



        function habilitar_seccion_de_pagos(){
                // Si es una salida DIARIA
                if($("#h_forma_salida").val()=="D"){ 
                    // si es una VENTA
                    if( $("#h_venta_o_reserva").val()=='V'){
                        $("#d_titulo_izquierdo3").css("display", "block"); 
                        $("#pagos").css("display", "block"); 
                        $("#visor_tipo_salida").html("Venta de pasaje para salida DIARIA");                         
                    }else{
                        // si es una RESERVA
                       $("#d_titulo_izquierdo3").css("display", "none"); 
                       $("#pagos").css("display", "none");  
                       $("#visor_tipo_salida").html("Reserva de pasaje para salida DIARIA"); 
                    }
                }else{                   
                    // Es una SALIDA ESPECIAL
                    $("#d_titulo_izquierdo3").css("display", "none"); 
                    $("#pagos").css("display", "none");  
                    $("#visor_tipo_salida").html("carga de datos para salidas ESPECIALES"); 
                }
        };

       //-------------------------------------------------------------------- 
       //--------------------------------------------------------------------
       // Grabamos el o los pasajes en la base de datos
       //--------------------------------------------------------------------
       //--------------------------------------------------------------------
       //--------------------------------------------------------------------
       //--------------------------------------------------------------------
       //--------------------------------------------------------------------
       function escribir_en_tabla(){
            var fila2 = [];    
            //var pagos = [];                     
            //-------------------------------------------------------------
            // datos para el escribir la tabla destinos_comunes_clientes
            var aux = $('#h_id_cliente').val();
            debugger;
            if ($("#h_datos").val()!=''){
            var destino_comunes = aux+"|"+
                                    $("#e_dni_pasaje").val()+ "|"+
                                    $("#e_destinatario").val()+     "|"+
                                    $("#e_direccion_destino_pasaje").val()+ "|"+
                                    $("#e_telefono_destino_pasaje").val()+ "|"+
                                    $("#e_prov_destinatario").val()+"|"+
                                    $("#e_loc_destinatario").val();                        
                                   
           
            if(confirm("Seguro de guardar los datos?")) { 
                   var aux = '';
                 /*----- sergio -----  
                   var todas_las_lineas ='';
                   var linea = '';
                   var loc_intermedias = '';
                   var i = 0;
                   
                   // Determinamos si es una salida diaria para aplicar el control de linea 
                   if($('#h_forma_salida').val()=='D'){
                        
                        // vemos el formato de lineas "Rqta-StaFe|1|7,9,2|3@"    
                        todas_las_lineas = $("#h_lineas").val().split("@");

                        // recorremos todas las lineas 
                        for(i=0; i<=todas_las_lineas.length-1; i++){
                            
                            linea = todas_las_lineas[i].split('|');
                            loc_intermedias = linea[2].split(",");  // el indice 2 nos proporciona el listado de localidades intermedia
                            
                            // NOTA: h_loc_or y h_loc_des son los id de la salida 
                            if( ( $("#e_listado_localidad_origen").val()==linea[1] )&&($("#e_listado_localidad_destino").val()==linea[3]) ){
                                aux = 'C';  
                            }else{
                                aux = 'P';                              
                            }
                            
                           // Determinamos si es un viaje completo o parcial -->                
                           // if( ( $("#e_listado_localidad_origen").val()==$("#h_loc_or").val() )&&($("#e_listado_localidad_destino").val()==$("#h_loc_de").val()) ){
                           //     aux = 'C';  
                           // }else{
                           //     aux = 'P';  
                           // } 
                        }                            
                   }
                   ----- sergio ----- */
            
                   aux = 'C'; // Se toma que todo asiento es usado desde el origen al destino 

                   var pagos = new Array();
                   $('#cuerpo_detalle_pagos > tr').each(function(){ //filas con clase 'dato', especifica una clase, asi no tomas el nombre de las columnas
                        var fila = $(this).find('td').eq(3).text();                        
                         pagos.push(fila);
                       // pagos.push(fila2);  
                   });                   
                   
                   var parametros = {
                                datos            : $("#h_datos").val(),
                                fv               : aux, // HAY QUE DETERMINAL SI ES UNA VIAJE COMPLETO O PARCIAL  
                                id_viaje         : $("#h_id_viaje").val(),
                                tipo             : $("#h_venta_o_reserva").val(),
                                e_pagos          : pagos, // datos del pago
                                e_destinos_comun : destino_comunes,                                
                                     }; 
                    
                    $.ajax({
                           data: parametros,
                           url : 'insertar_pasaje.php',
                           type: 'post',
                           
                           beforeSend: function () {
                               //$("#t_buscar").html("Procesando, espere por favor...");
                                                   },
                                                   
                           success:  function (resultado) {
                               aviso(resultado);
                               window.close();
                               
                       }
                    });                              
            }
        }else{
               mensaje("Error","Debe cargar los datos solicitados para poder aceptar el pasaje.");             
        }
       } 


//------------------------------------------------------------------------------
// Obtenemos el precio del pasaje y depositamos en el edit de precio
//------------------------------------------------------------------------------
        function seleccionar_tipo_pasaje(){
                var aux = 0;                
                aux = parseFloat( $("#e_mostrar_pago").html() );
                // verificamos que no se realiza un pago
                if(aux==0){
                 $("#e_importe_pasaje").attr("disabled",true);
                 //$("#h_operacion_tipo_pasaje").val();
                 var cad = $("#e_tipo_pasaje option:selected").html();
                 var subcad = cad.substring(cad.indexOf(' - $')+5, cad.length);

                 var cad2 = $("#e_tipo_pasaje option:selected").attr('value');
                 var subcad2 = cad2.substring(cad2.indexOf('#')+1, cad2.length);
                 
                 var aux = parseFloat(subcad);
                 $("#e_importe_pasaje").val(aux.toFixed(2));                 
                 
                 // verificamos si imprimimos un pasaje de ida y vuelta.
                 $("#h_operacion_selec_tipo_pasaje").val(subcad2[1]); // indica si es una impresion doble o no
                 
                 var aux3 = 0;
                 // si esta tildada la opcion de coseguro hacer calculo de coseguro
                 if($("#e_coseguro_pasaje").val()=='S'){
                    var aux2 = calculo_coseguro();
                    aux3 = aux + aux2;
                }else{
                    aux3 = aux;
                }
                
                $("#e_importe_pago").val( aux3.toFixed(2) ); // se agrega en la sexion de carga de importe de pagos.                                  
                $("#h_importe_deuda_pasaje").val($("#e_importe_pago").val());
            }else{
                mensaje_error("Error","Ya se ecuentra realizando un pago... no podra cambiar el tipo de pasaje.");
            }
        }
                        
//------------------------------------------------------------------------------
// Cierra la ventana 
//------------------------------------------------------------------------------
        function cerrar_ventana(){
            if (confirm('¿Segúro de cancelar la carga de pasajes?'))
                window.close();
        }
            
//------------------------------------------------------------------------------
// Realiza la busqueda de destinos mas comunes del clientes para autocompletar el remitente
//------------------------------------------------------------------------------
        function buscar_destinos_comunes_de_clientes(id_cliente) {                       
                var parametros = {id_cliente : id_cliente};
                
                $.ajax({
                           data: parametros,
                           url : 'ajax_buscar_destino_clientes.php',
                           type: 'post',
                           beforeSend: function () {
                               $("#t_buscar").html("Procesando, espere por favor...");
                                                   },
                           success:  function (resultado) {
                                    tbuscliente = resultado.split('|');
                                    $("#e_listado_localidad_destino").val(tbuscliente[5]);
                                    $("#e_direccion_destino_pasaje").val(tbuscliente[1]);
                                    $("#e_telefono_destino_pasaje").val(tbuscliente[2]);
                                    $("#e_celular_destino_pasaje").val('');
                            }
                 });
        };
        
        //-------------------------------------------------------------------------------
        // devuelve lo encontrado al precionar el boton aceptar del buscador de clientes
        //-------------------------------------------------------------------------------
        function seleccionar_cliente_buscado(carg_cliente){             
                var res = $('#h_seleccion').val(); // obtenemos (nro, dni, nombre, direccion, id_loc, localidad, id_prov, provincia, tel )               
                var res1 = res.split("|"); 
                
                if (carg_cliente==0){                   
                    // completamos lo de remitente    
                    $("#e_dni_remitente" ).val( res1[2] );
                    $("#e_remitente"     ).val( res1[3] );
                    $("#e_dir_remitente" ).val( res1[4] );
                    
                    $("#e_loc_remitente" ).attr('value', res1[5] );
                    $("#e_loc_remitente" ).val(res1[5]);
                    
                    $("#e_prov_remitente").attr('value', res1[7] ); 
                    $("#e_prov_remitente").val(res1[8]);
                    
                    $("#e_tel_remitente" ).val( res1[7] );  //-> 9   
                    
                    // Autocompleta los datos del destinatario buscando datos en 
                    // la tabla DESTINOS_COMUNES_CLIENTES
                 }else{
                    if (carg_cliente==1){                
                        // completamos lo de destinatario        
                        $("#h_id_cliente" ).             val(res1[1]);
                        
                        $("#e_dni_pasaje").              val(res1[2]);
                        $("#e_nombre_pasaje").           val(res1[3]);
                        //$("#e_listado_localidad_origen").val(res1[5]); //--> 6
                        //$("#e_listado_localidad_destino").val('');
                        $("#e_direccion_origen_pasaje"). val(res1[4]);
                        $("#e_direccion_destino_pasaje").val(res1[6]);
                        $("#e_telefono_origen_pasaje").val(res1[7]); //-> 9
                        
                        if (confirm("¿Autocompletar los datos de destino?")){
                            buscar_destinos_comunes_de_clientes(res1[1]);
                        }
                    }else{

                        // completamos lo de forma de pago
                        $("#e_cliente_ctacte" ).val( res1[3] );
                        $("#h_id_cliente_ctacte"     ).val( res1[0] );
                 }
                }
        }
        //----------------------------------------------------------------------------
        //----------------------------------------------------------------------------
        //----------------------------------------------------------------------------
        //----------------------------------------------------------------------------
        // habilitacion de loas formas de pago posible
        //----------------------------------------------------------------------------
        //----------------------------------------------------------------------------
        //----------------------------------------------------------------------------
        
    //-----------------------------------------------------------------------------------------    
    // realizamos la sumatoria de factores que hacen al calculo de un precio de pasaje a pagar.
    //-----------------------------------------------------------------------------------------
        function calculo_precio(){
            var i_c = 0.00; // importe del coseguro
            var i_p = 0.00; // importe del pasaje
            var i_pg = 0.00; // importe del pago acumulado.
            var res = 0.00; // valor del importe del pasaje + importe del coseguro  - pagos realizados
            
            i_c = parseFloat($("#e_importe_coseguro_pasaje").val());
            i_p = parseFloat($("#e_importe_pasaje").val());
            i_pg = parseFloat($("#h_total_pago").val());
            
            res = i_p + i_c - i_pg;
            
            $("#e_importe_pago").val(res.toFixed(2));
        }
        
        
        function seleccionar_forma_de_pagos(){   
           
                $("#e_importe_pago").        attr('disabled',true);
                $("#e_cliente_ctacte").      attr('disabled',true);
                $("e_buscar_cliente_ctacte").attr('disabled',true);
                $("e_buscar_cliente_ctacte").attr('disabled',true);
                $("#e_cheque_fecha_emision").attr('disabled',true);
                $("#e_cheque_fecha_cobro").  attr('disabled',true);
                $("#e_cheque_nro_cheque").   attr('disabled',true);
                $("#e_cheque_banco").        attr('disabled',true);
                $("#e_cheque_operacion").    attr('disabled',true);
                $("#e_cheque_a_nombre_de").  attr('disabled',true);
                $("#e_recibido_de").         attr('disabled',true);

                $("#div_ctacte").            attr('style',"display: none");
                $("#div_cheque").            attr('style',"display: none");

                $("#div_titulo_ctacte").     attr('style',"display: none");
                $("#div_titulo_cheque").     attr('style',"display: none");
                $("#div_titulo_contado").    attr('style',"display: none");
                $("#div_pago_destino").      attr('style',"display: none");
                
                // Si se cambio el tipo de pasaje y hay pagos realizados se verifica que quede todo correctamente
                // $("#e_importe_pago").val(  parseFloat($("#h_total_acumolado").val()).toFixed(2) - parseFloat($("#e_mostrar_pago").html()).toFixed(2));
                calculo_precio();
                
                // si es de contado
                if ($("#e_forma_de_pago_contado").is(":checked")) {
                    $("#e_importe_pago").attr('disabled',false);
                    
                    $("#e_importe_pago").focus();                   
                    $("#carga_datos_pagos").css('background-color',"#F5ECCE" );
                }else{ // si es un cheque
                    if ($("#e_forma_de_pago_cheque").is(":checked")) {

                        $("#div_cheque").  attr('style',"display: block");

                        $("#e_importe_pago").attr('disabled',        false);
                        $("#e_cheque_fecha_emision").attr('disabled',false);
                        $("#e_cheque_fecha_cobro").attr('disabled',  false);
                        $("#e_cheque_nro_cheque").attr('disabled',   false);
                        $("#e_cheque_banco").attr('disabled',        false);
                        $("#e_cheque_operacion").attr('disabled',    false);
                        $("#e_cheque_a_nombre_de").attr('disabled',  false);
                        $("#e_recibido_de").  attr('disabled',false);
                        $("#e_cheque_propio1").attr('disabled',  false);
                        $("#e_cheque_propio2").attr('disabled',  false);
                    
                        $("#e_cheque_fecha_emision").focus();
                        $("#carga_datos_pagos").css('background-color',"#A9D0F5" );
                    
                    }else{  // si es una cta. cte.
                            if ($("#e_forma_de_pago_ctacte").is(":checked")){   
                                $("#div_ctacte").  attr('style',"display: block");
                                $("e_buscar_cliente_ctacte").attr('disabled',false);
                                $("e_alta_cliente_ctacte").  attr('disabled',false);
                                //$("#e_importe_pago").val( parseFloat($("#h_total_acumolado").val()) - parseFloat($("#e_mostrar_pago").html()) );
                                $("#e_cliente_ctacte").focus();
                                $("#carga_datos_pagos").css('background-color',"#F8E0E6" );
                            }else{
                                $("#div_pago_destino").   attr('style',"display: block");  
                                $("#e_nombre_pago_destino").val($("#e_destinatario").val());
                                $("#e_nombre_pago_destino").focus();                                  
                                $("#carga_datos_pagos").css('background-color',"#E3D3FA" );
                            }
                   }
                }       
        }

//---------------------------------------------------------------------------------
// Verificamos que se cargen correctamente los cheques 
//----------------------------------------------------------------------------------
            function validar_carga_de_cheque(){
                     var aux = false;
                     if ( $("#e_cheque_banco").attr('id')==0){                        
                         // aviso('Debe completar a que Banco pertenece el cheque.');
                        swal({ 
                            title: "Error!",   
                            text: "Debe completar a que Banco pertenece el cheque.",   
                            type: "error",   
                            confirmButtonText: "Aceptar" 
                            });
                            
                         
                         
                         $("#e_cheque_banco").focus();
                     }else{
                        
                        if ( $("#e_cheque_nro_cheque").attr('id')==0){                        
                            aviso('Debe completar el nro de cheque.');
                            $("#e_cheque_nro_cheque").focus();
                        }else{
                             aux =  true;
                        }    
                     
                     }    
                     return aux;
            }
//---------------------------------------------------------------------------------
// Verificamos que se cargen correctamente los cheques 
//----------------------------------------------------------------------------------
            function validar_carga_de_ctacte(){
                     var aux = false;                     
                     if ($("#e_cliente_ctacte").val()==''){                        
                         aviso('Debe completar al cliente que contiene la cta. cte.');
                         $("#e_cliente_ctacte").focus();
                     }else{
                         aux = true;
                     }
                     return aux;
            }
//---------------------------------------------------------------------------------
// Verificamos que se cargen correctamente los datos de cobro en destino 
//----------------------------------------------------------------------------------
            function validar_pago_destino  (){
                     var aux = false;                                          
                     if ($("#e_nombre_pago_destino").val()==''){                        
                         aviso('Debe completar el destinatario para determinar donde y a quien cobrar.');
                         $("#e_destinatario").focus();
                     }else{
                         aux = true;
                     }
                     return aux;
            }
        
//-----------------------------------------------------------------------------------
// Completa el listado de pagos asociadas a la guia de encomienda.
// accion: registra el pago, contado, o cta. cte., o cheques. Incrementando el 
//          total de pagos.
//-----------------------------------------------------------------------------------
            function agregar_pago_al_listado_de_pago(){
                // verificamos que se halla seleccionado el tipo de pasaje y su 
                // importe correspondiente.
                if ($("#e_importe_pasaje").val()>0){
                
                    // Si el importe a agregar es mayor que cero
                    var importe = parseFloat($("#e_importe_pago").val()).toFixed(2);
            
                    if (importe>0) {                    
                        var dato_pago = '';
                        var a0 = parseInt( $("#h_cantidad_pago").val() ) + 1;
                        var a1 = 0.00;
                        var a2 = 0.00;
                        var a3 = 0.00;
                        var detalle_pago = '';
                    
                        var carga_correcta_cheque = 'S'; // bandera, indica si se cargo todos los datos de cheques
                        var carga_correcta_ctacte = 'S'; // bandera, indica si se cargo todos los datos de la ctacte
                    
                        //---------------------------------------------------------------------------------------------------------------------
                        // juntamos los datos para guardarlo en el objeto h_detalle_pago
                        // si es de contado y ctacte se completaran los espacios con ' '.                    
                        //---------------------------------------------------------------------------------------------------------------------
                        if ($("#e_forma_de_pago_contado").is(":checked")) {
                            detalle_pago = 'Efectivo';
                            dato_pago = '1#'+importe+'# # # # # # # # '; // completamos los espacios
                        }else{
                            if ($("#e_forma_de_pago_cheque").is(":checked")) {                             
                                //-----------------------------------------------------
                                // validamos los datos correctos para la carga de cheques
                                if (validar_carga_de_cheque()){
                               
                                    detalle_pago = 'Cheque Nro: '+$("#e_cheque_nro_cheque").val();    
                                    dato_pago = '2#'+importe+'#'+$("#e_cheque_fecha_emision").val()+'#'+$("#e_cheque_fecha_cobro").val()+'#'+
                                        $("#e_cheque_nro_cheque").val()+'#'+$("#e_cheque_operacion").val()+'#'+
                                        $("#e_cheque_a_nombre_de").val()+'#'+$("#e_recibido_de").val()+'#'+$("#e_cheque_banco").val()+'#'+$("input:radio[name=e_cheque_propio]:checked").val();
                            
                                    carga_correcta_cheque = 'S';
                                }else{
                                    carga_correcta_cheque = 'N';
                                }
                            
                            
                            }else{
                                if ($("#e_forma_de_pago_ctacte").is(":checked")) {
                                    if (validar_carga_de_ctacte()){
                                        detalle_pago = 'Cta. Cte.: '+$("#e_cliente_ctacte").val().toFixed(2);
                                        dato_pago = '3#'+importe+'#'+$("#h_id_cliente_ctacte").val().toFixed(2)+'# # # # # # # '; // completamos los espacios
                                        carga_correcta_ctacte = 'S';
                                    }else{    
                                        carga_correcta_ctacte = 'N'; 
                                    }
                                }else{
                                    if (validar_pago_destino()){                            
                                        detalle_pago = 'Pago Dest.';
                                        dato_pago = '4#'+importe+'# # # # # # # # '; // completamos los espacios
                                        carga_correcta_pago_destino = 'S';
                                    }else{
                                        carga_correcta_pago_destino = 'N';
                                    }
                                
                                }
                            }
                        }
                    
                    
                        //------------------------------------------------------------------------------------------------------
                        // verificamos que las variables de control de ingreso de dato para el pago correspondiente esten en 'S'
                        //------------------------------------------------------------------------------------------------------
                        if ((carga_correcta_ctacte=='S')&&(carga_correcta_cheque=='S')){
                       
                            //---------------------------------------------------------------------------------------------------------------------                   
                            var strNueva_Fila='<tr bgcolor="aaeeff">'+
                                '   <td align="left"><INPUT type="checkbox" NAME="chk2"></input></td>'+                                                
                                '   <td align="center">'+detalle_pago+'</td>'+
                                     '   <td align="center">$ '+importe+'</td>'+
                                     '   <td style="display:none" id="id0">'+dato_pago+'</td></tr>';                        
                             
                            var objTabla=$('#t_detalle_pagos').parents().get(2);
                   
                            a1 = parseFloat($("#e_importe_pago").val()).toFixed(2);   
                            a2 = parseFloat($("#h_total_pago").val()).toFixed(2);
                            a3 = parseFloat(a1) + parseFloat(a2);
                    
                            //agregamos la nueva fila a la tabla
                            $(objTabla).find('tbody').append(strNueva_Fila);
                            $("#h_cantidad_pago").val(a0);                  
                            $("#h_detalle_pago").val();                  
                            
                            $("#e_importe_pago").val( parseFloat(
                                    parseFloat($("#h_importe_deuda_pasaje").val()) 
                                     - (                                        
                                         parseFloat($("#e_importe_pago").val()) + parseFloat($("#e_mostrar_pago").html()) 
                                        )
                            ).toFixed(2));                            

                            
                            $("#h_total_pago"  ).val(a3.toFixed(2));
                            $("#e_mostrar_pago").html(a3.toFixed(2));   
                            $("#h_detalle_pago_venta").val();
                   
                            //si el cuerpo la tabla esta oculto (al agregar una nueva fila) lo mostramos
                            if (!$(objTabla).find('tbody').is(':visible')){
                                 //le hacemos clic al titulo de la tabla, para mostrar el contenido
                                $(objTabla).find('caption').click();
                            } 
                           // $("#h_importe_deuda_pasaje").val($("#e_importe_pago").val().toFixed(2));                                              
                                               
                        }// Finalizando la verificacion de ingreso de datos
                    
                    }else{
                        aviso("El importe del pago debe ser superior a 0.00...");
                    }                 
                }else{
                    aviso("No se puede registrar pago si no existe deuda...");
                }                
            }   
            
            //------------------------------------------------------------------
            // Limpiamos la grilla de pagos.
            //------------------------------------------------------------------
            function vaciar_tabla_pago(){
                //evento que se produce al hacer clic en el boton que elimina una tabla completamente
                //$(document).on('click','.clsEliminarTabla',function(){
                $("#t_detalle_pagos > tbody").empty();
                $("#h_cantidad_pago").val(0);
/*                
                var aux = 0;
                aux = parseFloat($('#e_importe_pasaje').val()).toFixed(2);
                
                var aux2 = 0;
                aux2 = parseFloat($("#h_total_pago").val()).toFixed(2);
                
                var res = 0;
                res = parseFloat(aux) +  parseFloat(aux2);
  */
                var res = 0;
                res = parseFloat($("#h_importe_deuda_pasaje").val()).toFixed(2);
                $('#e_importe_pago').val(res);
                $('#h_importe_deuda_pasaje').val(res);
                
                $("#h_total_pago").val(0.00);                
                $("#e_mostrar_pago").html("0.00");
            }
            //------------------------------------------------------------------
            //------------------------------------------------------------------
        
            //------------------------------------------------------------------
            //------------------------------------------------------------------
            function eliminar_pago_al_listado_pago(){
               try {
                    var mensaje = "Debe seleccionar un pago para eliminarlo...";
                    var table = document.getElementById("cuerpo_detalle_pagos");
                    var borrado = false; // determina si se realizo el borrado
                    var rowCount = table.rows.length; // determina la cantidad de filas
                    if (rowCount>1){
                        for(var i=0; i<rowCount; i++) {
                            
                            var row = table.rows[i];
                            var chkbox  = row.cells[0].childNodes[0];
                            var importe = row.cells[2].childNodes[0].nodeValue;
                            importe = importe.substring(1);

                            if((null != chkbox) && (true == chkbox.checked)) {
                                table.deleteRow(i);
                                rowCount--;
                                i--;
                                borrado = true;
                                // restamos de los totales
                                $("#h_cantidad_pago").val(   parseInt($("#h_cantidad_pago").val()) - 1);
                               
                                $("#h_total_pago").val( parseFloat( parseFloat($("#h_total_pago").val()) - importe));
                                
                                $("#e_mostrar_pago").html( parseFloat($("#h_total_pago").val()) );   
                                
                                debugger;
                                var aux1 = 0;
                                aux1 = parseFloat($("#h_importe_deuda_pasaje").val() );
                                
                                var aux2 = 0;
                                aux2 = parseFloat($("#h_total_pago").val());
                                
                                var res = 0;
                                res =  aux1 -  aux2;
                                
                                $("#e_importe_pago").val(res.toFixed(2));                            
                                //$("#h_importe_deuda_pasaje").val(res.toFixed(2));
                               
                            }                            
                        }
                        if(!borrado)
                            aviso(mensaje);
                    }else{
                        var row = table.rows[0];
                        var chkbox = row.cells[0].childNodes[0];
                        if((null != chkbox) && (true == chkbox.checked)) {
                            vaciar_tabla_pago();
                        }else{
                            aviso(mensaje);
                        }
                    }
               }catch(e) {
                    aviso(e);
               }                
            }

        //-----------------------------------------------------------------------
        // Vaciamos los edit de carga
        //-----------------------------------------------------------------------
            function vaciar_pasaje(){
                if(confirm("¿Segúro de limpiar los datos?")){
                    $("#e_dni_pasaje").val('');
                    $("#e_nombre_pasaje").val('');
                    $("#e_listado_localidad_origen").val('');
                    $("#e_listado_localidad_destino").val('');
                    $("#e_direccion_origen_pasaje").val('');
                    $("#e_direccion_destino_pasaje").val('');
                    $("#e_telefono_origen_pasaje").val('');
                    $("#e_telefono_destino_pasaje").val('');
                    $("#e_celular_origen_pasaje").val('');
                    $("#e_celular_destino_pasaje").val('');
                    $("#e_tipo_pasaje").val('');
                    $("#e_coseguro_pasaje").val('N');
                    $("#e_dni_coseguro_pasaje").val('');
                    $("#e_fecha_nacimiento_coseguro_pasaje").val();
                    $("#e_nombre_coseguro_pasaje").val('');
                    $("#e_importe_pasaje").val('');
                    $("#e_observaciones").val('');    
                    $("#e_fecha_nacimiento_coseguro_pasaje").val('');

                }
            }            
        //-----------------------------------------------------------------------
        // Volvemos a cargar los datos de uno de los pasajes en los edit de carga
        //-----------------------------------------------------------------------
           function recargar_pasaje_precargado(pasaje){
               var aux = pasaje.split("|");
               
              // $("#e_nro_asiento"              ).append('<option>'+aux[0]+'</option>');
              // $(this).parent().remove();
               
               $("#e_dni_pasaje"               ).val(aux[01]);
               $("#e_nombre_pasaje"            ).val(aux[02]);
               $("#e_listado_localidad_origen" ).val(aux[03]);
               $("#e_listado_localidad_destino").val(aux[04]);
               $("#e_direccion_origen_pasaje"  ).val(aux[05]);
               $("#e_direccion_destino_pasaje" ).val(aux[06]);
               $("#e_telefono_origen_pasaje"   ).val(aux[07]);
               $("#e_telefono_destino_pasaje"  ).val(aux[08]);
               $("#e_celular_origen_pasaje"    ).val(aux[09]);
               $("#e_celular_destino_pasaje"   ).val(aux[10]);
               $("#e_tipo_pasaje"              ).val(aux[11]);
               $("#e_coseguro_pasaje"          ).val(aux[12]);
               $("#e_dni_coseguro_pasaje"      ).val(aux[13]);
               $("#e_nombre_coseguro_pasaje"   ).val(aux[14]);
               $("#e_importe_pasaje"           ).val(aux[15]); 
               $("#e_observaciones"            ).val(aux[16]);  
               $("#e_fecha_nacimiento_coseguro_pasaje").val(aux[17]);
               
               $("#h_datos"                    ).val($("#h_datos").val()+pasajes);
           }    
        //-----------------------------------------------------------------------
        // Volvemos a cargar los datos de uno de los pasajes en los edit de carga
        //-----------------------------------------------------------------------
           function eliminar_pasaje_precargado(pasaje){              
                var aux = pasaje.split("|");             
                $("#e_nro_asiento").append("<option value="+aux[0]+">Asiento nro: "+$aux[0]+"</option>");               
                $(this).parent().remove();
           }

       //-----------------------------------------------------------------------------
       // cargamos el pasaje en el listado de pasajes que han sido cargados.
       //-----------------------------------------------------------------------------
            function cargar_listado_pasajes(pasaje){                
                var aux = pasaje.split("|");
                //aviso(pasaje);
                var aux2 ="<tr style='font-size: 13'>"+
                             "<td align='center'>"+aux[0]+"</td>"+
                             "<td>"+aux[2]+"</td>"+
                             "<td>"+aux[5]+"</td>"+
                             "<td>"+aux[7]+"</td>"+
                             "<td align='right' bgcolor='#8DFEB1'>$ "+aux[16]+"</td>"+                             
                             "<td><input id='i_recargar_pasaje"+aux[0]+"' align='center' type='image' src='./imagenes/edit.png'   onclick ='recargar_pasaje_precargado("+'"'+pasaje+'"'+");'/></td>"+              
                             "<td><input id='i_eliminar_pasaje"+aux[0]+"' align='center' type='image' src='./imagenes/delete.png' onclick ='eliminar_pasaje_precargado("+'"'+pasaje+'"'+");'/></td>"+
                           "</tr>";
                           //aviso(aux2);
               $("#t_listado_pasajes").append(aux2);
            }
            
//------------------------------------------------------------------------------
// guarda en el arreglo los datos del pasaje, limpia los edit dejando los 
// datos repetitivos para la nueva carga de pasaje.  
//------------------------------------------------------------------------------       
            function cargar_datos_base_a_otro_pasaje(){
                // verificamos que esten los datos cargados...
               if(validar_carga_pasaje()){
                   //-------------------------------------------------------------
                   // Determinamos el pago para el pasaje.                      
                   // recorremos la tabla de detalle pagos para generar un vector con los datos a guaradar en la tabla.
                   var filas_pagos = new Array();
                   $('#cuerpo_detalle_pagos > tr').each(function(){ //filas con clase 'dato', especifica una clase, asi no tomas el nombre de las columnas
                        var fila = $(this).find('td').eq(3).text();                        
                         filas_pagos.push(fila);
                       // pagos.push(fila2);  
                   });
                   
                    // retiramos las banderas de impresion doble 
                    // se recibe <id tipo pasaje>#'<S/N>|..|..|..|..| 
                    var cad2 = $("#e_tipo_pasaje option:selected").attr('value');
                    var tipo_pasaje = cad2.substring(0,cad2.indexOf('#'));
                   //aviso(tipo_pasaje);
                    
                    var pasajes = $("#e_nro_asiento").val();                // 0
                    pasajes = pasajes+"|"+$("#e_dni_pasaje").val();                 // 1
                    pasajes = pasajes+"|"+$("#e_nombre_pasaje").val();              // 2
                    pasajes = pasajes+"|"+$("#e_listado_localidad_origen").val();   // 3
                    pasajes = pasajes+"|"+$("#e_listado_localidad_destino").val();  // 4 
                    pasajes = pasajes+"|"+$("#e_direccion_origen_pasaje").val();    // 5
                    pasajes = pasajes+"|"+$("#e_direccion_destino_pasaje").val();   // 6
                    pasajes = pasajes+"|"+$("#e_telefono_origen_pasaje").val();     // 7
                    pasajes = pasajes+"|"+$("#e_telefono_destino_pasaje").val();    // 8
                    pasajes = pasajes+"|"+$("#e_celular_origen_pasaje").val();      // 9
                    pasajes = pasajes+"|"+$("#e_celular_destino_pasaje").val();     // 10
                    pasajes = pasajes+"|"+tipo_pasaje;                              // 11
                    pasajes = pasajes+"|"+$("#e_coseguro_pasaje").val();            // 12
                  
                    var fecha_coseguro = '';
                    if($("#e_coseguro_pasaje").val()=='N'){
                       fecha_coseguro = 'null'; 
                    }else{
                        fecha_coseguro = $("#e_fecha_nacimiento_coseguro_pasaje").val();
                    }
                    
                    pasajes = pasajes+"|"+$("#e_dni_coseguro_pasaje").val();         // 13
                    pasajes = pasajes+"|"+$("#e_nombre_coseguro_pasaje").val();      // 14
                    pasajes = pasajes+"|"+fecha_coseguro;                            // 15                             
                    pasajes = pasajes+"|"+$("#e_importe_pasaje").val();              // 16
                    
                    
                    // acumulamos el importe del total de los pasajes.
                    
                    var aux = 0.00; 
                    aux = parseFloat($("#h_total_acumolado").val()) + parseFloat($("#e_importe_pasaje").val()) + 
                          parseFloat( $("#e_importe_coseguro_pasaje").val() );    ;                    
                    $("#h_total_acumolado").val( aux.toFixed(2));
                    $("#sp_total_a_pagar").html( $("#h_total_acumolado").val() );
                                                           

                   pasajes = pasajes+"|"+$("#e_observaciones").val();                                //  17 
                   pasajes = pasajes+"|"+$("#e_importe_coseguro_pasaje").val()+"|"+filas_pagos+"@";  //  18                     
                                             

                    //------------------------------------------------                         
                    // agregamos los datos el pasaje al listado de carga de pasaje en h_datos        
                    //------------------------------------------------
                    $("#h_datos").val(  $("#h_datos").val() + pasajes  );
                    
                    //------------------------------------------------
                    // quitamos el asiento ya cargado
                    //------------------------------------------------
                    $("#e_nro_asiento").find("option[value='"+$("#e_nro_asiento").val()+"']").remove();
                    //------------------------------------------------
                    // limpiamos los datos que son propios del pasaje.
                    //------------------------------------------------
                    $("#e_dni_pasaje").val('');
                    $("#e_nombre_pasaje").val('');
                    $("#e_coseguro_pasaje").val('N');   
                    $("#e_dni_coseguro_pasaje").val('');                        
                    $("#e_nombre_coseguro_pasaje").val('');
                    $("#e_fecha_nacimiento_coseguro_pasaje").val('');  
                                        
                    $("#e_dni_pasaje").focus();
    
                    cargar_listado_pasajes(pasajes);       
               }else{
                   mensaje('Atención','Debe cargar todos los campos marcados como obligatorios...');
               }
             }

    
    
//-------------------------------------------------------------------------------
// cambiamos el estado de los datos del cooseguro
//-------------------------------------------------------------------------------
            function cambiar_estado_cooseguro(){  
                var aux = 0;                
                aux = parseFloat( $("#e_mostrar_pago").html() );                
                // verificamos que no se realiza un pago
                if(aux==0){
                
                    if ($("#e_coseguro_pasaje").val()=='N'){
                        $("#e_dni_coseguro_pasaje").attr("disabled",true);
                        $("#e_nombre_coseguro_pasaje").attr("disabled",true);
                        $("#e_fecha_nacimiento_coseguro_pasaje").attr("disabled",true);
                        $("#e_importe_coseguro_pasaje").val('0.00');                        
                    }else{                        
                        $("#e_dni_coseguro_pasaje").attr("disabled",false);
                        $("#e_fecha_nacimiento_coseguro_pasaje").attr("disabled",false);
                        $("#e_nombre_coseguro_pasaje").attr("disabled",false);                                                
                        $("#e_importe_coseguro_pasaje").val( calculo_coseguro());                        
                    }
                    calculo_precio();
                }else{
                    
                    mensaje_error("Error","Ya se ecuentra realizando un pago... no podra cambiar el tipo de pasaje.");
                    
                }
            }
            
            
//-------------------------------------------------------------------------------
// realizamos el calculo del coseguro segun el importe y el porcentaje aplicado
//-------------------------------------------------------------------------------
            function calculo_coseguro(){               
                 debugger;
                 aux1 = Number($("#sp_porcentaje_cooseguro").html().replace(/[^0-9\.]+/g,""));
                 aux2 = Number($("#e_importe_pasaje").val().replace(/[^0-9\.]+/g,""));
                 var aux = aux2 * aux1 / 100;
                 aviso(aux);
                 return  aux; 
            }
                        
//------------------------------------------------------------------------------------------
// realizamos las validaciones correspondientes para guardar el pasaje en la base de datos
//------------------------------------------------------------------------------------------
            function validar_carga_pasaje(){                 
                var mensaje = '';
                if($("#e_nro_asiento").val()==''){
                    mensaje = "Debe seleccionar el nro de asiento..."; 
                    $("#e_nro_asiento").focus()
                    $("#e_nro_asiento").css({ 'background': 'red' });
                }else{
                    $("#e_nro_asiento").css({ 'background': '#ffffff' });                    
                }
                
                if($("#e_dni_pasaje").val()=='')
                    {mensaje = "Debe ingresar el DNI del pasajero..."; 
                    $("#e_dni_pasaje").focus();
                    $("#e_dni_pasaje").css({ 'background': 'red' });
                }else{
                    $("#e_dni_pasaje").css({ 'background': '#ffffff' });                    
                }
                
                if($("#e_nombre_pasaje").val()=='')
                    {mensaje = "Debe ingresar el apellido y el nombre completo del pasajero...";
                    $("#e_nombre_pasaje").focus();
                    $("#e_nombre_pasaje").css({ 'background': 'red' });
                }else{
                    $("#e_nombre_pasaje").css({ 'background': '#ffffff' });                    
                }
                
                if($("#e_direccion_origen_pasaje").val()==''){
                    mensaje = "Debe ingresar la dirección origen del pasajero..."; 
                    $("#e_direccion_origen_pasaje").focus();
                    $("#e_direccion_origen_pasaje").css({ 'background': 'red' });
                }else{
                    $("#e_direccion_origen_pasaje").css({ 'background': '#ffffff' });                    
                }
                
                if($("#e_direccion_destino_pasaje").val()==''){
                    mensaje = "Debe ecribir la dirección destino del pasajero..."; 
                    $("#e_direccion_destino_pasaje").focus(); 
                    $("#e_direccion_destino_pasaje").css({ 'background': 'red' });
                }else{
                    $("#e_direccion_destino_pasaje").css({ 'background': '#ffffff' });                    
                }
                
                if(Number($("#e_importe_pasaje").val())<=0){
                    mensaje = "Debe seleccionar el tipo de pasaje..."; 
                    $("#e_tipo_pasaje").focus();
                    $("#e_tipo_pasaje").css({ 'background': 'red' });
                }else{
                    $("#e_tipo_pasaje").css({ 'background': '#ffffff' });                    
                }
                                    
                if ($("#e_coseguro_pasaje").val()=='S'){
                    if($("#e_dni_coseguro_pasaje").val()==''){
                        mensaje = "Debe completar los datos del coseguro...";
                        $("#e_dni_coseguro_pasaje").focus();
                        $("#e_dni_coseguro_pasaje").css({ 'background': 'red' });
                    }else{
                        $("#e_dni_coseguro_pasaje").css({ 'background': '#ffffff' });                    
                    }
                    if($("#e_nombre_coseguro_pasaje").val()==''){
                        mensaje = "Debe completar los datos del coseguro...";
                        $("#e_nombre_coseguro_pasaje").focus();
                        $("#e_nombre_coseguro_pasaje").css({ 'background': 'red' });
                    }else{
                        $("#e_nombre_coseguro_pasaje").css({ 'background': '#ffffff' });                    
                    }
                    if($("#e_fecha_nacimiento_coseguro_pasaje").val()==''){
                        mensaje = "Debe completar los datos del coseguro...";
                        $("#e_fecha_nacimiento_coseguro_pasaje").focus();
                        $("#e_fecha_nacimiento_coseguro_pasaje").css({ 'background': 'red' });
                    }else{
                        $("#e_fecha_nacimiento_coseguro_pasaje").css({ 'background': '#ffffff' });                    
                    }                                    
                }                
                
                //----------------------------------------------------------------------
                // verificamos que los datos de pago esten cargado segun la operacion
                //----------------------------------------------------------------------
                // si es una venta se obliga el pago
                if ($("#h_venta_o_reserva").val()=='V'){
                    // Verificamos que se halla pagado el pasaje si es una venta.
                    var aux = 0;
                    aux = parseFloat($("#e_mostrar_pago").html()).toFixed(2);
                    var aux2 = 0;
                    aux2 = parseFloat($("#h_importe_deuda_pasaje").val()).toFixed(2);
                    if(aux<aux2){
                        mensaje = 'Debe cargar el pago para cerrar la operatoria.';                    
                        $("#e_importe_pago").focus();
                        $("#e_importe_pago").css({ 'background': 'red' });                        
                    }else{                        
                        $("#e_importe_pago").css({ 'background': '#ffffff' });                        
                    }
                }
                
                
                
                //-- Verificamos que halla mas asiento para cargar sino se bloquea todos los texto --
                if(($("#e_nro_asiento option").length==1)&&(mensaje=='')){
                    $("#e_nro_asiento"              ).attr("disabled",true);
                    $("#e_dni_pasaje"               ).attr("disabled",true);
                    $("#e_nombre_pasaje"            ).attr("disabled",true);
                    $("#e_listado_localidad_origen" ).attr("disabled",true);
                    $("#e_listado_localidad_destino").attr("disabled",true);
                    $("#e_direccion_origen_pasaje"  ).attr("disabled",true);
                    $("#e_direccion_destino_pasaje" ).attr("disabled",true);
                    $("#e_telefono_origen_pasaje"   ).attr("disabled",true);
                    $("#e_telefono_destino_pasaje"  ).attr("disabled",true);
                    $("#e_celular_origen_pasaje"    ).attr("disabled",true);
                    $("#e_celular_destino_pasaje"   ).attr("disabled",true);
                    $("#e_tipo_pasaje"              ).attr("disabled",true);
                    $("#e_coseguro_pasaje"          ).attr("disabled",true);
                    $("#e_dni_coseguro_pasaje"      ).attr("disabled",true);
                    $("#e_nombre_coseguro_pasaje"   ).attr("disabled",true);
                    $("#e_importe_pasaje"           ).attr("disabled",true);
                    $("#e_observaciones"            ).attr("disabled",true);
                    $("#e_fecha_nacimiento_coseguro_pasaje").attr("disabled",true);                             
                }
                
                                       
                if (mensaje==''){
                    return true;
                }else{
                    //aviso(mensaje);
                    return false;                    
                }                        
             }
             
             
</script>       


<!-- Scrip para las pantallas desplegables -->       
<script type='text/javascript' src='./js/jquery.simplemodal.js'></script>
<script type='text/javascript' src='./js/osx.js'></script>             
 


<body>
    
    <input type="hidden" id="h_forma_salida" value={v_forma_salida} />      <!-- Guarda una letra E / D salida especial o directo -->
    <input type="hidden" id="h_id_viaje" value={v_id_viaje} />              <!-- Guarda el id del viaje seleccionado para mostrar el listado de los asientos -->
    <input type="hidden" id="h_seleccion" value="0"/>                       <!-- Guarda la informacion del cliente buscado con el div de busqueda -->    
    <input type="hidden" id="h_total_acumolado" value="0"/>                 <!-- Almacena el total de la venta de todos los pasaje seleccionado -->
    <input type="hidden" id="h_id_cliente" value="0"/>                      <!-- mantiene el id de cliente buscado para la venta del pasaje -->
    <input type="hidden" id="h_venta_o_reserva" value={v_venta_o_reserva}/> <!-- Guarda una letra V / R venta o reserva -->
    <input type="hidden" id="h_detalle_pago_venta" value=''/>               <!-- usado para acumular el detalle de los pagos a pasar para la escritura de las tabla  -->
    
    <input type="hidden" id="h_loc_or" value={v_loc_or}/> <!--  Guarda localidad de origen de la salida -->
    <input type="hidden" id="h_loc_de" value={v_loc_de}/> <!--  Guarda localidad de destino de la salida -->

    <input type="hidden" id="h_lineas" value={v_lineas}/> <!--  Guarda la cadena con las distintas lineas que posee la empresa -->
    <input type="hidden" id="h_operacion_selec_tipo_pasaje" value=''/>
    <input type="hidden" id="h_importe_deuda_pasaje" value=''/> <!-- Guarda el total adeudado por el pasaje -->
    
<!-- ------------------------------------------------    
      Guarda los datos de los asientos cargados 
------------------------------------------------- -->
<input type="hidden"  id="h_datos"/>

<div align="center">
<table border="1"  align="center" cellspacing="0" bordercolor="#DCDCDC" style="width:750">
    <tr>
            <td align="center"  style="background:{v_color_cabezera_tabla};  font:Arial; size:5;"  colspan="2">               
                <b>Alta de pasajes</b>
            </td>
                                 
    </tr>
        
    <tr>
            <!-- ---------------------------------------------------------------
                          Listado de Salidas por realizar                    	
            ---------------------------------------------------------------- -->	
            <td colspan="2" align="center">
                <br>               
		    <span id="visor_tipo_salida" >{v_datos_de_la_salidas}</span>
                <br>                
            </td>
            <!-- ---------------------------------------------------------------
		                    	Fin forma de pagos                    	
            ------------------------------------------------------------------->
            
    </tr>               
   
    <tr>
            
            <td>
                {v_listado_asientos_seleccionados}
            </td>
            <td valign='top'>
                <div id="d_titulo_izquierdo" align="center" style="background:{v_color_cabezera_columna}">
                    <h4>Detalle del pasaje</h4>
                </div>
                <div id="d_mostrar_datos_pasajero">                    
                    <table>
                        <tr><td>Nro asiento:        </td><td><b> <select id="e_nro_asiento">{v_listado_nro_asiento}</select> </b></td></tr>
                        <tr><td>D.N.I.:             </td><td><b> <input id="e_dni_pasaje"    type="number"  value="{v_dni_pasaje} "/> 
                                                                 <input type="image" src="./imagenes/busqueda.png" border="0" name="e_buscar_destinatario" id="e_buscar_destinatario" value="Buscar_destinatario" class="osx demo"/>
                                                                 <input type="image" src="./imagenes/agregar.png" border="0" name="e_alta_destinatario" id="e_alta_destinatario" /></b></td></tr>
                        <tr><td>Nombre:             </td><td><b> <input id="e_nombre_pasaje" type="text"  value="{v_nombre_pasaje}"/>                </b></td></tr>

                        <tr bgcolor="{v_color_origen}" ><td>Localidad origen:   </td><td><b> <select id="e_listado_localidad_origen" >{v_listado_localidad_origen}</select>     </b></td></tr>                
                        <tr bgcolor="{v_color_origen}" ><td>Dirección origen:   </td><td><b> <input id="e_direccion_origen_pasaje" type="text"  value="{v_direccion_origen_pasaje} "/>     </b></td></tr>                
                        <tr bgcolor="{v_color_origen}" ><td>Teléfono origen:    </td><td><b> <input id="e_telefono_origen_pasaje" type="tel"  value="{v_telefono_origen_pasaje} "/>      </b></td></tr>                
                        <tr bgcolor="{v_color_origen}" ><td>Celular origen:     </td><td><b> <input id="e_celular_origen_pasaje" type="tel"  value="{v_celular_origen_pasaje} "/>       </b></td></tr>                

                        <tr bgcolor="{v_color_destino}"><td>Localidad destino:  </td><td><b> <select id="e_listado_localidad_destino" >{v_listado_localidad_destino}</select>     </b></td></tr>
                        <tr bgcolor="{v_color_destino}" ><td>Dirección destino:  </td><td><b> <input id="e_direccion_destino_pasaje" type="text"  value="{v_direccion_destino_pasaje}"/>     </b></td></tr>                
                        <tr bgcolor="{v_color_destino}" ><td>Teléfono destino:   </td><td><b> <input id="e_telefono_destino_pasaje" type="tel"  value="{v_telefono_destino_pasaje} "/>     </b></td></tr>                
                        <tr bgcolor="{v_color_destino}" ><td>Celular destino:    </td><td><b> <input id="e_celular_destino_pasaje" type="tel"  value="{v_celular_destino_pasaje}"/>       </b></td></tr>                                        

                        <tr><td>Tipo Pasaje:        </td><td><b> <select id="e_tipo_pasaje">{v_listado_tipo_pasaje}> </select>                </b></td></tr>
                                                   
                        <tr><td>Coseguro:           </td><td><b> <select id="e_coseguro_pasaje"><option value="S">SI</option><option value="N">NO</option></select>              </b></td></tr>   
                        <tr><td>D.N.I. Coseguro:    </td><td><b> <input id="e_dni_coseguro_pasaje" type="number"  value="{v_dni_coseguro_pasaje}" disabled=""/>          </b></td></tr>                        
                        <tr><td>Nombre Coseguro:    </td><td><b> <input id="e_nombre_coseguro_pasaje" type="text"  value="{v_nombre_coseguro_pasaje}" disabled=""/>      </b></td></tr>
                        <tr><td>Fecha Nacimiento:   </td><td><b> <input id="e_fecha_nacimiento_coseguro_pasaje" type="date"  value="{v_fecha_nacimiento_coseguro_pasaje}" disabled=""/> </b></td></tr>                        
                        <tr><td>Importe:            </td><td><b> <input id="e_importe_pasaje" type="text"  value="{v_importe_pasaje}" disabled="" size="5x"/> Coseguro %:<span id='sp_porcentaje_cooseguro' >{v_porsentaje_coseguro}</span>=<input id="e_importe_coseguro_pasaje" type="text"  value="{v_importe_coseguro_pasaje}" disabled="" size="5x"/> </b></td></tr>                
                        <tr><td>Observaciones:      </td><td>    <input id="e_observaciones" type="text"  value="{v_observaciones}"  />                                      </td></tr>
                    </table>
                    <br>
                        
                </div>      
         </td>
    </tr>
    <tr>        
        <td colspan="2">
                     <!-- ------------------------------------------------------------------------------------------------------------------- -->
                     <!-- ******************************************************************************************************************* -->
                     <!-- ------------------------------------------------------------------------------------------------------------------- -->
                <div id="pagos"  style="display: none;">
                    <table id="t_form_pago"  width="100%" cellspacing="0" border="1" >
                    <tr>
                        <td colspan="9" bgcolor="{v_color_cabezera_columna}">
                            <b>Forma de pago</b><br>

                        </td>
                    </tr>
                    <tr>                    
                        <td colspan="9" >
                            <input type="radio" id="e_forma_de_pago_contado" checked name="e_forma_de_pago" value="0">Contado
                            <input type="radio" id="e_forma_de_pago_ctacte"          name="e_forma_de_pago" value="2">Cta.Cte.                                                         
                        </td>
                    </tr>
                    <tr>
                        <!-- ------------------------------------------------------------------------------------
                            forma de pagos                      
                        -------------------------------------------------------------------------------------- -->  
                        <td height="39" colspan="5" align="right" >
                            <!-- --------- Detalle de titulos ------------------------- -->
                            <div align="left" id="carga_datos_pagos">

                                <div id="div_ctacte" style="display: none">
                                    Nombre Cta.Cte.:<input type="text" id="e_cliente_ctacte" size="30" disabled=false/>
                                    <input type="hidden" id="h_id_cliente_ctacte"/>
                                    <input  type="image" src="./imagenes/busqueda.png"  name="e_buscar_cliente_ctacte" id="e_buscar_cliente_ctacte" value="Buscar_cliente_ctacte" class='osx demo' />
                                    <input  type="image" src="./imagenes/agregar.png"  name="e_alta_cliente_ctacte" id="e_alta_cliente_ctacte"  />                          
                                </div>                                                                        

                                <br>              
                            
                                <div id="div_cheque" style="display: none">              
                                    Fecha Emision:<input type="date" id="e_cheque_fecha_emision" disabled/>
                                    Fecha Cobro:  <input type="date" id="e_cheque_fecha_cobro" disabled /><br>
                                    Nro. Cheque:  <input type="text" id="e_cheque_nro_cheque" size="10" disabled/>
                                    <input type="hidden" id="h_id_banco"/>
                                    Banco:<select name="e_cheque_banco" size="1" id="e_cheque_banco" disabled>
                                     {v_comboBox_banco}
                                    </select>
                                        <input type="image" src="./imagenes/agregar.png" name="e_alta_banco_ctacte" id="e_alta_banco_ctacte" />                          
                                        <br>
                                        Operación:<input type="text" id="e_cheque_operacion" size="50" disabled/><br>
                                        A nombre de:<input type="text" id="e_cheque_a_nombre_de" size="50" disabled/><br>
                                        Recibido de:<input type="text" id="e_recibido_de" size="50" disabled/><br>
                                        Cheque propio:    Si:<input type="radio" name="e_cheque_propio" id="e_cheque_propio1" value="S" checked disabled/>
                                                          No:<input type="radio" name="e_cheque_propio" id="e_cheque_propio2" value="N" disabled/>
                                </div>                                    
                                
                                <div id="div_pago_destino" style="display: none">              
                                    Paga en destino:<input type="text" id="e_nombre_pago_destino" size="50" disabled/>
                                </div>                                                                        
                                    Importe:<input type="text" id="e_importe_pago" size="10" /><br>                            
                                <br>                                
                                </div>
                            
                        </td>
                            
                        <td>
                            
                            <input type="image" src="./imagenes/seleccion_izq.jpg"  name="b_agregar_pago" id="b_agregar_pago" value="Agregar" /><br>                                                                                    
                            <input type="image" src="./imagenes/seleccion_der.jpg"  name="b_eliminar_pago" id="b_eliminar_pago" value="-" />

                        </td>
                        <td height="39" colspan="3">
                             
                            <div id="divContenedorTabla_pagos" align="center">                               
                            <input type="image" src="./imagenes/vaciar_tabla.png" value="Vaciar la tabla" id="b_vaciar_la_tabla_pago">                                                                                
                            <table id="t_detalle_pagos" border="1" align="center" cellspacing="0">
                
                                <thead>
                                    <tr> 
                                        <th>                                            
                                        </th>
                                        <th>                                                       
                                            Tipo de pago:
                                        </th>                                            
                                        <th>
                                            Importe
                                            <input type="hidden" id="h_cantidad_pago"value="{v_cantidad_pago}"/>                                            
                                            <input type="hidden" id="h_detalle_pago" value="{v_detalle_pago}"/>
                                            <input type="hidden" id="h_total_pago" value="{v_total_pago}"/>                                            
                                        </th>
                                    </tr>                                                                      
                                </thead>
                                
                                <tbody id="cuerpo_detalle_pagos">
                                </tbody>
                                
                                <tfoot>
                                    <tr>
                                        <td colspan="2">Total pagado:</td>
                                        <td><span id="e_mostrar_pago">{v_total_pago}</span></td>
                                    </tr>
                                </tfoot>
                            </table>
                            </div>                            
                            
                        </td>                     
                    <!-- ------------------------------------------------------------------------------------
                        fin forma de pagos                      
                    ---------------------------------------------------------------------------------------->                           
                    </tr>
                   
               </table>
               
           </div>            
                     
                     
                     <!-- ------------------------------------------------------------------------------------------------------------------- -->
                     <!-- ******************************************************************************************************************* -->
                     <!-- ------------------------------------------------------------------------------------------------------------------- -->
                        
                        
                        
                        
                        
                        
                        
                        <div align="center" style="background-color:#FFDDDD; visibility:visible">
                            <input id="i_vaciar_pasaje" align="center"  type="image" src="./imagenes/vaciar_tabla.png"/>Vaciar pasaje
                            
                            <input id="i_escribir_siguiente_pasaje" align="center"  type="image" src="./imagenes/nuevo_pasaje.jpg"/>Sig. pasaje
                        </div>
                        
                
        </td>
    </tr>
    <tr>
        <td colspan="2">
                <div id="d_titulo_izquierdo2" align="center" style="background:{v_color_cabezera_columna}">
                    <h4>Pasajes cargados</h4>
                </div>
                <div id="d_mostrar_listado_pasajero" align="center">                   
                    <table  width="100%" border="1"  id="t_listado_pasajes" align="center" cellspacing="0" bordercolor="#DCDCDC" style="width:200">
                        <thead>
                            
                            <tr align="center">
                                <th>Asto</th>
                                <th>Nombre    </th>
                                <th>Dirección </th>
                                <th>Tel       </th>
                                <th>Importe   </th>
                            </tr>
                            
                        </thead>
                        <tbody>                            
                            <tr>
                                <td align="center">{v_nro_siento_cliente}</td>
                                <td>{v_nombre_cliente}    </td>
                                <td>{v_direccion_cliente} </td>
                                <td>{v_tel_cliente}       </td>
                                <td align="right">{v_importe_cliente}   </td>                                
                            </tr>                       
                        </tbody>
                        <tfoot>                           
                            <tr>
                                <td colspan="3">{v_nombre_cliente}</td>
                                <td>{v_direccion_cliente}         </td>
                            </tr>                       
                        </tfoot>
                        
                    </table>     
                    <br>
                </div>
            </td>            
     </tr>
     <tr>
            <td colspan="2">
                <div id="d_titulo_izquierdo3" align="center" style="background:{v_color_cabezera_columna}">
                    <h4>Datos del pago</h4>                    
                </div>
                Total a pagar:<span id="sp_total_a_pagar">0</span>
           </td>           
     </tr>  
    <tr>
        <td colspan="2" align="center" bgcolor="{v_color_mando_botonera_mando}">
                <!--
                --------------------------------------------------------------------------------
                -------------   Botonera de mando ----------------------------------------------
                -------------------------------------------------------------------------------- 
                -->
                
                <div style="float: center; margin-bottom: 15px;margin-top: 5px; width: 250px;">
                    
                    <div style="
                           
                            background-color:{v_color_fondo_boton_mando};
                            color:{v_color_texto_boton_mando};
                            border:2px inset #6E6E6E;
                            float:right;
                            margin-left: 10px;
                            cursor:pointer;   
                            width: 90px;
                                ">
                        <input id="i_aceptar" type="image" src="./imagenes/ok.png" value="Aceptar" />
                        <br>Aceptar
                    </div>    

                    <div style="
                              /*  float: left;
                                font-family:Arial; 
                                font-size: 8;
                                margin: 2;
                                border: 1px solid #cccccc;
                                background-color: #ffffff; 
                                width:  55; 
                                height: 30; */
                            background-color:{v_color_fondo_boton_mando};
                            color:{v_color_texto_boton_mando};
                            border:2px inset #6E6E6E;
                            float:left;
                            margin-right:10px;
                            cursor:pointer;                               
                            width: 90px;
                                ">
                        <input id="i_cancelar" type="image" src="./imagenes/cancelar.gif"   value="cancelar" />
                        <br>Cancelar
                    </div>
                    
                </div>             
                
        </td>
    </tr>
</table>
                   



</div>

 
<!-- ---------------------------------------------------------------------------
--------------------------------------------------------------------------------
Sextor de POPUP de busqueda de clientes
--------------------------------------------------------------------------------
---------------------------------------------------------------------------- -->
<div id="osx-modal-content">
    <div id="osx-modal-title">Buscandor de Clientes...</div>
    <div class="close"><a href="#" class="simplemodal-close">x</a></div>
    <div id="osx-modal-data">
	<h2>Buscar</h2>
        <input name="e_buscar" type="text"  id="e_buscar" size="35"/>
        <input name="b_buscar" type="image" src="./imagenes/busqueda.png" id="b_buscar" />
        
        <!-- Sector de grilla -->
        <span id="t_buscar"> </span>

	<p> 
            
            <input type="image" class="simplemodal-close" src="./imagenes/ok.png"       id="b_aceptar_clientes"  size="15" />Aceptar
            <input type="image" class="simplemodal-close" src="./imagenes/cancelar.gif" id="b_cancelar_cliente" />Cancelar   <span>(Presione ESC para cancelar)</span>

        </p>
    </div>
</div>
    
</body>
</html>


    